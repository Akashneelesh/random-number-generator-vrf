---
phase: 04-deployment-verification
plan: 02
type: execute
---

<objective>
Update frontend with deployed contract address and verify complete end-to-end VRF transaction flow on Sepolia testnet.

Purpose: Connect the deployed contract to the React frontend and validate that the entire system works correctly with real on-chain randomness.
Output: Working frontend integrated with deployed contract, verified E2E transaction flow with successful random number generation.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-deployment-verification/04-01-SUMMARY.md
@frontend/src/contracts/constants.ts
@frontend/src/components/RandomNumberForm.tsx
@frontend/src/components/ResultDisplay.tsx

**Tech stack available:**
- React 18.3.1 with Vite 5.4.21
- @starknet-react/core v3.5.0 for wallet integration
- starknet.js v6.11.0 for contract interaction
- Contract deployed on Sepolia (address from 04-01)

**Established patterns:**
- Frontend constants in frontend/src/contracts/constants.ts
- VRF multicall pattern: [request_random, generate_random_in_range]
- Auto-refresh after transaction with 3-second delay
- Form validation and contract read hooks

**Constraining decisions:**
- Phase 3: RANDOM_RANGE_GENERATOR_ADDRESS is placeholder "0x0", must be updated
- Phase 3: Auto-refresh pattern with useEffect trigger after transaction
- Phase 2: Contract uses Source::Nonce(caller) for non-deterministic randomness

**From Phase 4 Plan 1:**
Contract deployed with address from 04-01-SUMMARY.md (to be injected during execution)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update frontend constant with deployed contract address</name>
  <files>frontend/src/contracts/constants.ts</files>
  <action>Replace the placeholder RANDOM_RANGE_GENERATOR_ADDRESS value "0x0" with the actual deployed contract address from Phase 4 Plan 1 (04-01-SUMMARY.md). The address should be in the format "0x..." as returned by starkli deploy. Do NOT change VRF_PROVIDER_ADDRESS (it remains 0x051fea4450da9d6aee758bdeba88b2f665bcbf549d2c61421aa724e9ac0ced8f).</action>
  <verify>cat frontend/src/contracts/constants.ts shows non-zero RANDOM_RANGE_GENERATOR_ADDRESS matching deployed address</verify>
  <done>Frontend constant updated with real Sepolia contract address</done>
</task>

<task type="auto">
  <name>Task 2: Build frontend to verify no compilation errors</name>
  <files>frontend/</files>
  <action>Run `cd frontend && npm run build` to verify TypeScript compilation succeeds with the updated contract address. This ensures no type errors or import issues exist before testing. Build should complete without errors or warnings (deprecation warnings from dependencies are acceptable).</action>
  <verify>npm run build completes with exit code 0, dist/ directory created</verify>
  <done>Frontend builds successfully with deployed contract address</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete VRF random range generator with deployed contract on Sepolia testnet</what-built>
  <how-to-verify>
    1. Start frontend: cd frontend && npm run dev
    2. Open browser to http://localhost:5173 (or displayed URL)
    3. Connect wallet (Argent X or Braavos) - ensure connected to Sepolia testnet
    4. Ensure wallet has Sepolia ETH (get from https://starknet-faucet.vercel.app/ if needed)
    5. Test random number generation:
       - Enter Min: 1000, Max: 1300
       - Click "Generate Random Number"
       - Approve transaction in wallet
       - Wait for transaction confirmation (10-30 seconds)
       - Verify result appears automatically after ~3 seconds
       - Confirm result is between 1000-1300 inclusive
    6. Test multiple generations:
       - Try Min: 1, Max: 100 - verify result in range
       - Try Min: 500, Max: 600 - verify result in range
       - Each call should produce different random numbers (Source::Nonce)
    7. Test validation:
       - Try Min: 100, Max: 50 - should show validation error "Min must be less than Max"
       - Try empty fields - should show validation error
    8. Test result display:
       - After successful generation, verify "Last Random Number" card shows:
         - Random value
         - Min and Max values used
       - Click "Refresh" button - should fetch latest result
    9. Check browser console - no errors (CORS warnings from public RPC are acceptable)
    10. Verify transaction on Sepolia explorer:
        - Transaction should show multicall with VRF-wrapped calls
        - Event "RandomGenerated" should be emitted with correct values
  </how-to-verify>
  <resume-signal>Type "approved" if all tests pass, or describe any issues found for fixing</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] Frontend constant updated with deployed address
- [ ] npm run build succeeds without errors
- [ ] Wallet connection works on Sepolia
- [ ] VRF transaction executes successfully
- [ ] Random number generated within specified range
- [ ] Result display shows correct values
- [ ] Multiple transactions produce different random numbers
- [ ] Form validation prevents invalid inputs
</verification>

<success_criteria>

- Frontend integrated with deployed contract
- Complete E2E transaction flow verified on Sepolia testnet
- Random number generation works correctly with VRF
- Result fetching and display working
- User can generate multiple random numbers successfully
- No errors in transaction execution or result display
</success_criteria>

<output>
After completion, create `.planning/phases/04-deployment-verification/04-02-SUMMARY.md`:

# Phase 04-02: Frontend Integration & E2E Verification Summary

**[One-liner about successful E2E verification]**

## Accomplishments

- Frontend constant updated with deployed contract address
- Complete E2E VRF transaction flow verified on Sepolia
- Random number generation tested across multiple ranges
- Form validation confirmed working
- Result display and auto-refresh verified

## Files Created/Modified

- `frontend/src/contracts/constants.ts` - Updated RANDOM_RANGE_GENERATOR_ADDRESS with deployed contract

## Decisions Made

[Any decisions made during verification, or "None"]

## Issues Encountered

[Any issues and resolutions, or "None"]

## Next Step

Ready for 04-03-PLAN.md (Documentation)
</output>
